JavaScript projects guidelines
==============================

> This document contains the guidelines that must be followed for JavaScript projects under the IPFS org. These guidelines result from battle earned experience in building JavaScript applications and modules that are reusable, work in the browser and that offer a good UX for developers.

# Motivation and goals

The creation of this document came as a result of the hurdles that the IPFS community had to go through, in order to build a JavaScript codebase that is welcoming in supporting new features to increase productivity and developer happiness, without the trading off the interopability with other existent and predominant tools.

## Goals

Out goals for each JavaScript project are:

- Be browser compatible, if possible (exceptions are for modules that require native bindings).
- Not break CommonJS `require`. This means that if someone requires a JavaScript module from the IPFS ecosystem, they should be able to require and use browserify, webpack and other bundlers directly, without having to worry how much shims have to be added to make it work.
- Make the UX of contributing and developing great with good guides, saving a lot of time in discussions that can be used for productivity.

# Design & Implementation decisions

Over time, we've research the options available in the JavaScript ecosystem and these are the collection of our design and implementation decisions, when it comes to: project stucture, code style, ci, tests, tasks and dependency management.

## Project structure

A project structure should have the following components

```sh
.
├── dist # auto-generated by the transpile and minification task.
│   ├── browser.js
│   └── browser.min.js
├── lib  # auto-generated source tree, transpiled using babel. Makes the code es5 compatible/
│   ├── index.js
│   └── ...
├── src  # source code. Can use the latest features (es2015(6)/es2016(7)) in JavaScript.
│   ├── index.js
│   └── ...
├── tests # testes folder
├── package.json
├── README.md
├── CONTRIBUTING.md
├── circle.yml
├── .travis.yml
└── node_modules
```

Inside the package.json, the main file exported is the one from the auto-generated source tree, transpiled using babel. While the original gets pointed by the `jsnext:main` key.

```JavaScript
// ...
"main": "lib/index.js",
"jsnext:main": "src/index.js",
// ...
```

The original source tree can be still required in the conventioal CommonJS way, using `require('module-name/src')`.

To avoid checking in the dist and lib folders, the contents of the `.gitignore` file should at least be:

```
dist
lib
**/node_modules
**/*.log
coverage
```

The browser minified versions should be publishes to IPFS and npmcdn, offering a convinient way for a developer to include the module through a script tag.

## Code style

We follow the [JavaScript Standard codestyle](http://github.com/feross/standard) accross our JavaScript projects. To learn more about the codestyle, visit [standardjs.com](http://standardjs.com).

## Testing libraries

- Testing Node.js: [mocha](https://mochajs.org/)
- Assertions: [chai](http://chaijs.com/)
- Testing browser: [karma](https://karma-runner.github.io/0.13/index.html) and reusing the tests built for Node.js with [mocha](https://mochajs.org/)

## Code coverage

We use [Istanbul](http://npmjs.org/istanbul) for code coverage checking, reusing tests that were made using mocha.

## Building a es5 version

// WIP

## Building a dist version for the browser

// WIP

- Browser building: [webpack](https://webpack.github.io/) or [browserify](http://browserify.org/).

## Continuous integration

Our picks are:

- [circle CI](https://circleci.com)
- [travis CI](https://travis-ci.org)

## Dependencies management

We use:

- [david-dm](https://david-dm.org/)
- [greenkeeper](http://greenkeeper.io/) to keep your deps up to date.

## Tasks and task runners

We use a mix of `npm scripts` for small tasks (small projects) and for more complex tasks, our task runner of choice is [gulp](http://gulpjs.com/).

We also use [precommit](https://www.npmjs.com/package/pre-commit) to enforce running code style verification and tests on every commit.

# Project example

// WIP

# Contributing

Follow these conventions described in this document.

When reporting a bug, if possible, provide a way to reproduce or even better, write a test that fails with your case

Always run tests before pushing and PR'ing your code

# Code of Conduct

Any IPFS JavaScript project follows the same [Code of Conduct](https://github.com/ipfs/community/blob/master/code-of-conduct.md) applied to the whole IPFS ecosystem.

# References - Resources and good reads

- Comparission between WebPack, browserify, requirejs, jspm and rollup - https://github.com/webpack/docs/wiki/comparison
